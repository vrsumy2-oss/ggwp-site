{% extends 'base.html' %}
{% block content %}
<h1>Marketplace</h1>
<!-- Category Filter Buttons -->
<div style="margin-bottom: 20px;">
    <button onclick="loadItems()">All</button>
    <button onclick="loadItems('dota-2')">Dota 2</button>
    <button onclick="loadItems('cs2')">CS2</button>
</div>
<div id="items-list">Loading...</div>
<script>
    async function loadItems(gameSlug = '') {
        let url = '/api/items/';
        if (gameSlug) {
            url += `?game=${gameSlug}`;
        }
        const response = await fetch(url);
        const items = await response.json();

        const list = document.getElementById('items-list');
        list.innerHTML = '';
        items.forEach(item => {
            // Check if image exists
            const imgHtml = item.image ? `<img src="${item.image}" style="width:100%; height:150px; object-fit:cover;">` : '';

            const div = document.createElement('div');
            div.className = 'card';
            div.style.maxWidth = '250px'; // Make cards smaller
            div.style.display = 'inline-block';
            div.style.margin = '10px';
            div.style.verticalAlign = 'top';
            div.innerHTML = `
                <a href="/items/${item.id}/" style="text-decoration: none; color: inherit;">
                    ${imgHtml}
                    <h3 style="margin: 10px 0;">${item.title}</h3>
                    <p style="color: #bb86fc; font-weight:bold;">Price: $${item.price}</p>
                    <p style="font-size: 0.9em; color: #ccc;">${item.description}</p>
                </a>
            `;
            list.appendChild(div);
        });
    }
    loadItems();
</script>
{% endblock %}